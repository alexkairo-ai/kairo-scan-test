<!doctype html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<title>Готовность производства</title>

<link rel="icon" href="favicon.ico" sizes="any">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/svg+xml" href="favicon.svg">

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#111111">
<link rel="apple-touch-icon" href="apple-touch-icon.png">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

<link rel="stylesheet" href="styles.css">
</head>
<body>
<div class="wrap">

<div id="mainView">
 <div class="card">
 <button id="refreshBtn" title="Обновить">↻</button>
 <div class="badge">Готовность производства</div>
 <h2>Сканируйте QR заказа</h2>
 <video id="video" autoplay playsinline muted></video>
 <canvas id="canvas" style="display:none;"></canvas>
 <div id="msg" class="small"></div>
 <button id="startCam">СКАНИРОВАТЬ</button>
 </div>

 <div class="card">
 <div class="grid">
 <input id="order" placeholder="QR / номер заказа" autofocus />
 <input id="worker" placeholder="Имя сотрудника" />
 </div>
 </div>

 <div class="card">
 <h3 id="stageTitle">Выберите этап:</h3>
 <div id="stageButtons">
 <button data-stage="pila">Пила</button>
 <button data-stage="hdf">ХДФ</button>
 <button data-stage="kromka">Кромка</button>
 <button data-stage="prisadka">Присадка</button>
 <button data-stage="upakovka">Упаковка</button>
 <button data-stage="hdf" data-only="pila-hdf" data-color="#f39931">ПИЛА ХДФ</button>
 </div>
 <div id="status">Готово к работе</div>
 </div>

 <div class="card">
 <button id="openReports">ОТЧЁТЫ</button>
 </div>
</div>

<div id="reportsView" class="hidden">
 <div class="card">
 <div class="badge">Отчёты</div>

 <div class="filters">
 <button data-filter="day">За день</button>
 <button data-filter="week">За неделю</button>
 <button data-filter="month">За месяц</button>
 <button data-filter="all">Все</button>
 </div>

 <div class="tools">
 <input id="searchInput" placeholder="Поиск..." />
 <select id="sortSelect">
 <option value="time_desc">Сортировка: время ↓</option>
 <option value="time_asc">Сортировка: время ↑</option>
 <option value="date_desc">Сортировка: дата ↓</option>
 <option value="date_asc">Сортировка: дата ↑</option>
 <option value="order_asc">Сортировка: заказ ↑</option>
 <option value="order_desc">Сортировка: заказ ↓</option>
 <option value="db_asc">Сортировка: таблица ↑</option>
 <option value="db_desc">Сортировка: таблица ↓</option>
 </select>
 </div>

 <div class="tools" style="margin-top:8px;">
 <input type="date" id="statsDate">
 <select id="statsStage">
 <option value="all">Этап: все</option>
 <option value="pila">Пила</option>
 <option value="hdf">ХДФ</option>
 <option value="kromka">Кромка</option>
 <option value="prisadka">Присадка</option>
 <option value="upakovka">Упаковка</option>
 </select>
 <button id="statsBtn" style="width:auto;font-size:12px;padding:6px8px;border-radius:10px;">Посчитать</button>
 <span id="statsResult" class="small" style="margin-left:6px;"></span>
 </div>

 <div class="tools" style="margin-top:8px;">
 <input type="date" id="pdfFrom">
 <input type="date" id="pdfTo">
 <button id="exportPdf" style="width:auto;font-size:12px;padding:6px8px;border-radius:10px;">Экспорт PDF</button>
 </div>

 <div id="reportsStatus" class="small" style="margin-top:8px;">Найдено:0</div>
 <div style="overflow:auto;margin-top:10px;">
 <table class="table" id="reportsTable">
 <thead>
 <tr>
 <th>Заказ</th><th>Дата</th><th>Время</th><th>Этап</th><th>Сотрудник</th><th>Таблица</th><th class="row-actions">Действия</th>
 </tr>
 </thead>
 <tbody></tbody>
 </table>
 </div>
 <button id="openPhotoStore">АРХИВ ФОТО</button>
 <button id="editReports">Редактировать</button>
 <button id="closeReports" style="margin-top:8px;">Назад</button>
 </div>
</div>

</div>

<div id="printArea"></div>

<script src="https://unpkg.com/jsqr/dist/jsQR.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jspdf-autotable@3.5.29/dist/jspdf.plugin.autotable.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

<script src="app.js" defer></script>
</body>
</html>
